{
  "pluginAlias": "ipx800",
  "pluginType": "platform",
  "singular": true,
  "schema": {
    "api": {
      "type": "object",
      "properties": {
        "ip": {
          "type": "string",
          "default": "192.168."
        },
        "key": {
          "type": "string"
        },
        "version": {
          "type": "string",
            "default": "v4",
            "enum": ["v4", "v5"],
            "required": true
        }
      }    
    },
    "relays": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "displayName": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "default": "light",
            "oneOf": [
              { "title": "light (fr:lumière)", "enum": ["light"] },
              { "title": "outlet (fr:prise)", "enum": ["outlet"] },
              { "title": "fan (fr:ventilation)", "enum": ["fan"] },
              { "title": "switch (fr:interrupteur)", "enum": ["switch"] },
              { "title": "button (fr:poussoir)", "enum": ["bswitch"] },  
              { "title": "valve", "enum": ["valve"]}
            ],
            "required": true
          },
          "index": {
            "type": "number"
          }
        } 
      }
    },
    "dimmers": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "displayName": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "default": "light",
            "oneOf": [
              { "title": "light (fr:lumière)", "enum": ["light"] },
              { "title": "fan (fr:ventilation)", "enum": ["fan"] },
              { "title": "window covering (fr:volet/rideau)", "enum": ["covering"] }
            ],
            "required": true
          },
          "index": {
            "type": "number"
          },
          "anaIndex": {
            "condition": {
              "functionBody": "return model.api.version && model.api.version!=='v4'"
            },
            "type": "number"
          }
        } 
      }
    },
    "analogInputs": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "displayName": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "default": "temperature",
            "oneOf": [
              { "title": "humidity sensor (fr:capteur d’humidity)", "enum": ["humidity"] },
              { "title": "light sensor (fr:capteur de luminosité)", "enum": ["light"] },
              { "title": "temperature sensor (fr:thermomètre)", "enum": ["temperature"] }      
            ],
            "required": true
          },
          "index": {
            "type": "number"
          }
        } 
      }
    },
    "inputs": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "displayName": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "default": "switch",
            "oneOf": [
              { "title": "mouvement sensor (fr:détecteur de mouvement)", "enum": ["motion"] },
              { "title": "switch (fr:interrupteur)", "enum": ["switch"] }   ,
              { "title": "contact sensor (fr:contacteur)", "enum": ["contact"] }   
            ],
            "required": true
          },
          "index": {
            "type": "number"
          }
        } 
      }
    }
  },
  "layout": [
    {
      "expandable": true,
      "expanded": true,
      "key": "api",
      "title": "Ipx Api configuration",
      "type": "array",
      "items" : [ 
        {"key": "api.ip", "title": "ipx ip"}, 
        {"key": "api.key", "title": "ipx api key"},
        {"key": "api.version", "title": "ipx version"}
      ]
    },
    {
      "expandable": true,
      "expanded": false,
      "key": "relays",
      "title": "relays and on/off devices",
      "type": "array",
      "orderable": true,
      "buttonText": "Add relay",
      "items": [
        {"key":"relays[].displayName", "title": "displayed name (fr: nom affiché)"},
        {"key":"relays[].type"},
        {"key":"relays[].index", "description": "api number on V4, io index on V5"}
      ]
    },
    {
      "expandable": true,
      "expanded": false,
      "key": "dimmers",
      "type": "array",
      "orderable": true,
      "buttonText": "Add dimmer",
      "items": [
        {"key":"dimmers[].displayName", "title": "displayed name (fr: nom affiché)"},
        {"key":"dimmers[].type"},
        {"key":"dimmers[].index", "description": "api number on V4, io index on V5"},
        {"key":"dimmers[].anaIndex", "title": "ana/consigne index", "description": "consigne index on V5, to get brightness level"}
      ]
    },
    {
      "expandable": true,
      "expanded": false,
      "key": "inputs",
      "type": "array",
      "orderable": true,
      "buttonText": "Add inputs/sensors",
      "items": [
        {"key":"inputs[].displayName", "title": "displayed name (fr: nom affiché)"},
        {"key":"inputs[].type"},
        {"key":"inputs[].index", "description": "api number on V4, io index on V5"}
      ]
    },
    {
      "expandable": true,
      "expanded": false,
      "key": "analogInputs",
      "type": "array",
      "orderable": true,
      "buttonText": "Add xthl and analog sensors",
      "items": [
        {"key":"analogInputs[].displayName", "title": "displayed name (fr: nom affiché)"},
        {"key":"analogInputs[].type"},
        {"key":"analogInputs[].index", "description": "api number on V4, io index on V5"}
      ]
    }
  ]  
}